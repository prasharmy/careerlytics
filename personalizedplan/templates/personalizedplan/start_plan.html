{% extends "users/user_tailwind_base.html" %}
{% load static %}

{% block title %}Start Personalized Plan{% endblock %}

{% block contents %}
<div class="py-6 px-0 sm:px-2 lg:px-4 relative overflow-hidden">
    <!-- Background Elements -->
    <div class="absolute top-0 right-0 -translate-y-1/2 translate-x-1/4 w-[500px] h-[500px] bg-blue-500/10 rounded-full blur-3xl pointer-events-none"></div>
    <div class="absolute bottom-0 left-0 translate-y-1/2 -translate-x-1/4 w-[500px] h-[500px] bg-purple-500/10 rounded-full blur-3xl pointer-events-none"></div>

    <div class="max-w-7xl mx-auto grid grid-cols-1 lg:grid-cols-2 gap-6 lg:gap-10 items-start relative z-10">
        
        <!-- Left Column: Value Proposition -->
        <div class="space-y-5 lg:sticky lg:top-6 pt-2">
            <div>
                <span class="inline-block px-3 py-1.5 bg-blue-100 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400 rounded-full text-xs font-bold uppercase tracking-wider mb-2">
                    üöÄ Career Accelerator
                </span>
                <h1 class="text-3xl lg:text-4xl font-black text-slate-900 dark:text-white leading-tight mb-2">
                    Your Personalized <br>
                    <span class="text-blue-600 dark:text-blue-400">Learning Path</span>
                </h1>
                <p class="text-base text-slate-600 dark:text-slate-400">
                    Stop guessing what to learn next. Get a custom-tailored 4-week curriculum based on your actual skill level.
                </p>
            </div>

            <!-- Features Grid -->
            <div class="grid grid-cols-1 sm:grid-cols-2 gap-3">
                <div class="bg-white dark:bg-slate-800 p-5 rounded-2xl border border-slate-200 dark:border-slate-700 shadow-sm hover:shadow-md transition-shadow">
                    <div class="h-11 w-11 bg-slate-100 dark:bg-slate-700 rounded-xl flex items-center justify-center text-xl mb-3">
                        üéØ
                    </div>
                    <h3 class="font-bold text-slate-900 dark:text-white mb-1">Adaptive Plan</h3>
                    <p class="text-xs text-slate-500">Curriculum adjusts to your strengths and weaknesses.</p>
                </div>
                <div class="bg-white dark:bg-slate-800 p-5 rounded-2xl border border-slate-200 dark:border-slate-700 shadow-sm hover:shadow-md transition-shadow">
                    <div class="h-11 w-11 bg-slate-100 dark:bg-slate-700 rounded-xl flex items-center justify-center text-xl mb-3">
                        ‚ö°
                    </div>
                    <h3 class="font-bold text-slate-900 dark:text-white mb-1">Daily Actions</h3>
                    <p class="text-xs text-slate-500">Bite-sized tasks that fit into your busy schedule.</p>
                </div>
                <div class="bg-white dark:bg-slate-800 p-5 rounded-2xl border border-slate-200 dark:border-slate-700 shadow-sm hover:shadow-md transition-shadow">
                    <div class="h-11 w-11 bg-slate-100 dark:bg-slate-700 rounded-xl flex items-center justify-center text-xl mb-3">
                        üèÜ
                    </div>
                    <h3 class="font-bold text-slate-900 dark:text-white mb-1">Gamified Growth</h3>
                    <p class="text-xs text-slate-500">Earn XP, maintain streaks, and unlock achievements.</p>
                </div>
                <div class="bg-white dark:bg-slate-800 p-5 rounded-2xl border border-slate-200 dark:border-slate-700 shadow-sm hover:shadow-md transition-shadow">
                    <div class="h-11 w-11 bg-slate-100 dark:bg-slate-700 rounded-xl flex items-center justify-center text-xl mb-3">
                        üìà
                    </div>
                    <h3 class="font-bold text-slate-900 dark:text-white mb-1">Real Impact</h3>
                    <p class="text-xs text-slate-500">Directly improve your resume score and interview readiness.</p>
                </div>
            </div>
        </div>

        <!-- Right Column: Interactive Form -->
        <div class="bg-white dark:bg-slate-800 rounded-3xl shadow-xl border border-slate-200 dark:border-slate-700 p-5">
            <form method="post" id="plan-form" class="space-y-5">
                {% csrf_token %}
                
                <!-- Step 1: Choose Path -->
                <div>
                    <h2 class="text-lg font-bold text-slate-900 dark:text-white mb-3 flex items-center">
                        <span class="flex items-center justify-center w-7 h-7 rounded-full bg-blue-100 text-blue-600 text-xs font-bold mr-2">1</span>
                        Choose Your Path
                    </h2>
                    
                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-3">
                        <!-- Role Based Option -->
                        <label class="relative group cursor-pointer">
                            <input type="radio" name="plan_type" value="role" class="peer sr-only" required checked>
                            <div class="p-4 rounded-xl border-2 border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900 peer-checked:border-blue-600 dark:peer-checked:border-blue-400 peer-checked:bg-blue-50 dark:peer-checked:bg-blue-900/10 peer-checked:shadow-md transition-all hover:border-blue-300">
                                <div class="mb-3">
                                    <span class="text-3xl">üíº</span>
                                </div>
                                <h3 class="font-bold text-slate-900 dark:text-white peer-checked:text-blue-700 dark:peer-checked:text-blue-400">Role-Based</h3>
                                <p class="text-xs text-slate-500 mt-1 peer-checked:text-blue-600/80 dark:peer-checked:text-blue-300/80">Frontend, Backend, Fullstack, etc.</p>
                            </div>
                        </label>

                        <!-- Language Based Option -->
                        <label class="relative group cursor-pointer">
                            <input type="radio" name="plan_type" value="language" class="peer sr-only">
                            <div class="p-4 rounded-xl border-2 border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900 peer-checked:border-purple-600 dark:peer-checked:border-purple-400 peer-checked:bg-purple-50 dark:peer-checked:bg-purple-900/10 peer-checked:shadow-md transition-all hover:border-purple-300">
                                <div class="mb-3">
                                    <span class="text-3xl">‚ö°</span>
                                </div>
                                <h3 class="font-bold text-slate-900 dark:text-white peer-checked:text-purple-700 dark:peer-checked:text-purple-400">Language-Based</h3>
                                <p class="text-xs text-slate-500 mt-1 peer-checked:text-purple-600/80 dark:peer-checked:text-purple-300/80">Python, JavaScript, Java, etc.</p>
                            </div>
                        </label>
                    </div>
                </div>

                <!-- Step 2: Select Target -->
                <div id="target-selection-container" class="transition-all duration-300">
                    <h2 class="text-lg font-bold text-slate-900 dark:text-white mb-3 flex items-center">
                        <span class="flex items-center justify-center w-7 h-7 rounded-full bg-blue-100 text-blue-600 text-xs font-bold mr-2">2</span>
                        Select Your Focus
                    </h2>

                    <!-- Role Options Grid -->
                    <div id="role-options" class="grid grid-cols-2 gap-3 animate-fade-in">
                        {% for role in roles %}
                            <label class="cursor-pointer">
                                <input type="radio" name="target" value="{{ role }}" class="peer sr-only" required>
                                <div class="p-2.5 rounded-lg border border-slate-200 dark:border-slate-700 hover:bg-slate-50 dark:hover:bg-slate-700 peer-checked:border-blue-600 dark:peer-checked:border-blue-400 peer-checked:bg-blue-50 dark:peer-checked:bg-blue-900/20 peer-checked:text-blue-700 dark:peer-checked:text-blue-300 peer-checked:shadow-sm peer-checked:font-bold transition-all text-center text-sm font-medium text-slate-700 dark:text-slate-300">
                                    {{ role|title }}
                                </div>
                            </label>
                        {% endfor %}
                    </div>

                    <!-- Language Options Grid (Hidden by default) -->
                    <div id="language-options" class="grid grid-cols-2 gap-3 hidden animate-fade-in">
                        {% for language in languages %}
                            <label class="cursor-pointer">
                                <input type="radio" name="target" value="{{ language }}" class="peer sr-only" required>
                                <div class="p-2.5 rounded-lg border border-slate-200 dark:border-slate-700 hover:bg-slate-50 dark:hover:bg-slate-700 peer-checked:border-purple-600 dark:peer-checked:border-purple-400 peer-checked:bg-purple-50 dark:peer-checked:bg-purple-900/20 peer-checked:text-purple-700 dark:peer-checked:text-purple-300 peer-checked:shadow-sm peer-checked:font-bold transition-all text-center text-sm font-medium text-slate-700 dark:text-slate-300">
                                    {{ language|title }}
                                </div>
                            </label>
                        {% endfor %}
                    </div>
                </div>

                <!-- Step 3: Action -->
                <div class="pt-5 border-t border-slate-200 dark:border-slate-700">
                    <button type="submit" class="group relative w-full flex justify-center py-3 px-4 border border-transparent text-base font-bold rounded-xl text-white bg-slate-900 hover:bg-slate-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-slate-900 transition-all shadow-lg hover:shadow-xl transform hover:-translate-y-0.5 overflow-hidden">
                        <span class="absolute top-0 left-0 w-full h-full bg-gradient-to-r from-blue-600 to-purple-600 opacity-0 group-hover:opacity-100 transition-opacity duration-300"></span>
                        <span class="relative flex items-center">
                            Start Assessment
                            <span class="material-symbols-rounded ml-2 group-hover:translate-x-1 transition-transform text-lg">arrow_forward</span>
                        </span>
                    </button>
                    <p class="text-center text-xs text-slate-500 mt-4">
                        Takes ~10 minutes ‚Ä¢ Comprehensive Analysis ‚Ä¢ Instant Plan Generation
                    </p>
                </div>
            </form>
        </div>
    </div>
</div>

<style>
    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(10px); }
        to { opacity: 1; transform: translateY(0); }
    }
    .animate-fade-in {
        animation: fadeIn 0.3s ease-out forwards;
    }
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const roleOptions = document.getElementById('role-options');
    const languageOptions = document.getElementById('language-options');
    const planTypeInputs = document.querySelectorAll('input[name="plan_type"]');
    
    // Function to handle plan type toggle
    function togglePlanType(type) {
        // Reset all target inputs
        document.querySelectorAll('input[name="target"]').forEach(input => {
            input.checked = false;
        });

        if (type === 'role') {
            roleOptions.classList.remove('hidden');
            languageOptions.classList.add('hidden');
            // Re-trigger animation
            roleOptions.classList.remove('animate-fade-in');
            void roleOptions.offsetWidth; // Trigger reflow
            roleOptions.classList.add('animate-fade-in');
        } else {
            roleOptions.classList.add('hidden');
            languageOptions.classList.remove('hidden');
            // Re-trigger animation
            languageOptions.classList.remove('animate-fade-in');
            void languageOptions.offsetWidth; // Trigger reflow
            languageOptions.classList.add('animate-fade-in');
        }
    }

    // Add event listeners to plan type radio buttons
    planTypeInputs.forEach(input => {
        input.addEventListener('change', function() {
            togglePlanType(this.value);
        });
    });

    // Initialize state based on default checked input
    const checkedInput = document.querySelector('input[name="plan_type"]:checked');
    if (checkedInput) {
        togglePlanType(checkedInput.value);
    }
});
</script>
{% endblock %}