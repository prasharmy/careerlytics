<!DOCTYPE html>
<html class="light" lang="en"><head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Test Results - Mock Test</title>
<link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&display=swap" rel="stylesheet"/>
<script src="https://cdn.tailwindcss.com?plugins=forms,typography,container-queries"></script>
<script>
      tailwind.config = {
        darkMode: "class",
        theme: {
          extend: {
            colors: {
              primary: "#6366f1",
              "background-light": "#f8fafc",
              "background-dark": "#0f172a",
              "accent-green": "#22c55e",
              "accent-orange": "#f97316",
              "accent-red": "#ef4444",
            },
            fontFamily: {
              display: ["Plus Jakarta Sans", "sans-serif"],
            },
            borderRadius: {
              DEFAULT: "1rem",
              'xl': '1.5rem',
              '2xl': '2rem',
              '3xl': '2.5rem',
            },
          },
        },
      };
    </script>
<style type="text/tailwindcss">
        .material-symbols-outlined {
            font-variation-settings: 'FILL' 0, 'wght' 400, 'GRAD' 0, 'opsz' 24;
            display: inline-block;
            vertical-align: middle;
        }
        .custom-scrollbar::-webkit-scrollbar {
            width: 6px;
        }
        .custom-scrollbar::-webkit-scrollbar-track {
            background: transparent;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: #e2e8f0;
            border-radius: 10px;
        }
        .dark .custom-scrollbar::-webkit-scrollbar-thumb {
            background: #334155;
        }
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
        .glass-panel {
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }
        .dark .glass-panel {
            background: rgba(30, 41, 59, 0.7);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        .theme-toggle-btn {
            @apply flex items-center justify-center bg-slate-100 dark:bg-slate-800 rounded-full w-10 h-10 cursor-pointer transition-all hover:ring-2 hover:ring-indigo-400 dark:hover:ring-indigo-600;
        }
    </style>
</head>
<body class="bg-background-light dark:bg-background-dark font-display text-slate-800 dark:text-slate-100 h-screen overflow-hidden flex flex-col transition-colors duration-300">

<!-- Header -->
<header class="glass-panel border-b border-slate-200 dark:border-slate-800 px-4 lg:px-6 py-2 lg:py-3">
<div class="flex items-center justify-between">
<div class="flex items-center gap-3 lg:gap-4">
<button class="w-10 h-10 lg:w-12 lg:h-12 rounded-xl lg:rounded-2xl bg-gradient-to-br from-green-500 to-green-600 text-white flex items-center justify-center shadow-lg">
<span class="material-symbols-outlined text-white text-xl">emoji_events</span>
</button>
<div>
<h1 class="font-extrabold text-lg lg:text-xl tracking-tight">Test Results</h1>
<p class="text-xs font-semibold text-slate-500 dark:text-slate-400 uppercase tracking-wider">Performance Summary</p>
</div>
</div>
<div class="flex items-center gap-2 lg:gap-3">
<button class="theme-toggle-btn" onclick="toggleTheme()">
<svg class="w-5 h-5 text-amber-500 dark:hidden" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zM2 13h2c.55 0 1-.45 1-1s-.45-1-1-1H2c-.55 0-1 .45-1 1s.45 1 1 1zm18 0h2c.55 0 1-.45 1-1s-.45-1-1-1h-2c-.55 0-1 .45-1 1s.45 1 1 1zM11 2v2c0 .55.45 1 1 1s1-.45 1-1V2c0-.55-.45-1-1-1s-1 .45-1 1zm0 18v2c0 .55.45 1 1 1s1-.45 1-1v-2c0-.55-.45-1-1-1s-1 .45-1 1zM5.99 4.58c-.39-.39-1.03-.39-1.41 0-.39.39-.39 1.03 0 1.41l1.06 1.06c.39.39 1.03.39 1.41 0s.39-1.03 0-1.41L5.99 4.58zm12.37 12.37c-.39-.39-1.03-.39-1.41 0-.39.39-.39 1.03 0 1.41l1.06 1.06c.39.39 1.03.39 1.41 0 .39-.39.39-1.03 0-1.41l1.06-1.06zm1.06-10.96c.39-.39.39-1.03 0-1.41-.39-.39-1.03-.39-1.41 0l-1.06 1.06c.39.39 1.03.39 1.41 0 .39-.39.39-1.03 0-1.41l1.06-1.06zm7.05 18.36c.39-.39.39-1.03 0-1.41-.39-.39-1.03-.39-1.41 0l-1.06 1.06c.39.39 1.03.39 1.41 0s1.03.39 1.41 0l1.06-1.06z"></path>
</svg>
<svg class="w-5 h-5 text-indigo-400 hidden dark:block" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M12 3c-4.97 0-9 4.03-9 9s4.03 9 9 9 9-4.03 9-9c0-.46-.04-.92-.1-1.36-.98 1.37-2.58 2.26-4.4 2.26-2.98 0-5.4-2.42-5.4-5.4 0-1.81.89-3.42 2.26-4.4-.44-.06-.9-.1-1.36-.1z"></path>
</svg>
</button>
<button class="px-5 py-2.5 rounded-full border border-slate-200 dark:border-slate-700 font-bold text-sm hover:bg-slate-50 dark:hover:bg-slate-800 transition-all flex items-center gap-2 group" onclick="backToDashboard()">
<svg class="w-5 h-5 text-slate-500 group-hover:text-primary transition-colors" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z"></path>
</svg>
<span>Dashboard</span>
</button>
</div>
</div>
</header>

<!-- Main Content -->
<main class="flex-1 flex flex-col lg:flex-row overflow-hidden">
<!-- Left Sidebar -->
<aside class="w-20 lg:w-20 border-r border-slate-200 dark:border-slate-800 flex flex-row lg:flex-col items-center py-4 lg:py-6 gap-4 lg:gap-6 bg-white dark:bg-slate-900 overflow-x-auto lg:overflow-x-hidden">
<button class="w-10 h-10 lg:w-12 lg:h-12 rounded-xl lg:rounded-2xl bg-green-50 dark:bg-green-900/30 text-green-600 flex items-center justify-center relative group flex-shrink-0" title="Results">
<span class="material-symbols-outlined text-xl">emoji_events</span>
<span class="absolute left-full ml-4 px-2 py-1 bg-slate-800 text-white text-xs rounded opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap pointer-events-none">Test Results</span>
<div class="absolute -left-0 top-1/2 -translate-y-1/2 w-1 h-6 bg-green-600 rounded-r-full"></div>
</button>
<button class="w-12 h-12 rounded-2xl text-slate-400 dark:text-slate-500 hover:bg-slate-100 dark:hover:bg-slate-800 flex items-center justify-center relative group" title="Dashboard">
<span class="material-symbols-outlined text-xl">dashboard</span>
</button>
<button class="w-12 h-12 rounded-2xl text-slate-400 dark:text-slate-500 hover:bg-slate-100 dark:hover:bg-slate-800 flex items-center justify-center relative group" title="Retake Test">
<span class="material-symbols-outlined text-xl">refresh</span>
</button>
</aside>

<section class="flex-1 overflow-y-auto no-scrollbar bg-slate-50 dark:bg-slate-950 p-2 lg:p-4">
<div class="max-w-7xl mx-auto space-y-4 mb-4">

<!-- Results Summary Card -->
<div class="w-full bg-white dark:bg-slate-900 p-3 lg:p-4 rounded-xl lg:rounded-2xl shadow-sm border border-slate-200 dark:border-slate-800" id="results-data" {% if results %}data-results-loaded="true"{% endif %}>
    <!-- Progress Section -->
    <div class="mb-8 p-4 bg-slate-50 dark:bg-slate-800/50 rounded-xl border border-slate-100 dark:border-slate-700">
        <div class="flex flex-col sm:flex-row items-center justify-between gap-4 mb-4">
            <div class="flex items-center gap-3">
                <span class="material-symbols-outlined text-green-500 text-2xl">emoji_events</span>
                <h3 class="font-bold text-slate-700 dark:text-slate-200 uppercase tracking-wider text-xs">Overall Progress</h3>
            </div>
            <div class="text-xs font-bold text-green-600 dark:text-green-400 bg-green-50 dark:bg-green-900/20 px-3 py-1 rounded-full border border-green-100 dark:border-green-800">
                {{ xp_progress }} / {{ xp_threshold }} XP to Level {{ next_level }}
            </div>
        </div>
        <div class="h-3 w-full bg-slate-100 dark:bg-gray-700 rounded-full overflow-hidden">
            <div class="h-full bg-green-500 rounded-full transition-all duration-1000 ease-out" style="width: {{ progress_percentage }}%"></div>
        </div>
    </div>

<div class="text-center mb-6">
<div class="w-20 h-20 bg-gradient-to-br from-green-400 to-green-600 rounded-full flex items-center justify-center mx-auto mb-6 shadow-2xl">
<span class="material-symbols-outlined text-4xl text-white">emoji_events</span>
</div>
<h2 class="text-3xl font-black text-transparent bg-clip-text bg-gradient-to-r from-green-500 to-green-700 mb-4">{{ results.percentage }}%</h2>
<div class="inline-flex items-center px-4 py-2 bg-{{ performance_color|default:'gray' }}-100 text-{{ performance_color|default:'gray' }}-800 rounded-full text-lg font-medium mb-4">
{{ results.performance_level }}
</div>
<p class="text-gray-600 text-lg">{{ results.message }}</p>
</div>

        <!-- Stats Grid -->
        <div class="grid grid-cols-2 md:grid-cols-4 gap-3 md:gap-6 mb-8">
            <div class="text-center p-4 md:p-6 bg-green-50 dark:bg-green-900/10 rounded-xl border border-green-100 dark:border-green-900/20">
                <div class="text-xl md:text-3xl font-bold text-green-600 dark:text-green-400">{{ results.correct_answers }}</div>
                <div class="text-[10px] md:text-sm text-gray-600 dark:text-gray-400 mt-1 uppercase font-bold tracking-wider">Correct</div>
            </div>
            <div class="text-center p-4 md:p-6 bg-red-50 dark:bg-red-900/10 rounded-xl border border-red-100 dark:border-red-900/20">
                <div class="text-xl md:text-3xl font-bold text-red-600 dark:text-red-400">{{ results.wrong_answers }}</div>
                <div class="text-[10px] md:text-sm text-gray-600 dark:text-gray-400 mt-1 uppercase font-bold tracking-wider">Wrong</div>
            </div>
            <div class="text-center p-4 md:p-6 bg-blue-50 dark:bg-blue-900/10 rounded-xl border border-blue-100 dark:border-blue-900/20">
                <div class="text-xl md:text-3xl font-bold text-blue-600 dark:text-blue-400">{{ results.total_questions }}</div>
                <div class="text-[10px] md:text-sm text-gray-600 dark:text-gray-400 mt-1 uppercase font-bold tracking-wider">Total</div>
            </div>
            <div class="text-center p-4 md:p-6 bg-purple-50 dark:bg-purple-900/10 rounded-xl border border-purple-100 dark:border-purple-900/20">
                <div class="text-xl md:text-3xl font-bold text-purple-600 dark:text-purple-400">{{ results.percentage }}%</div>
                <div class="text-[10px] md:text-sm text-gray-600 dark:text-gray-400 mt-1 uppercase font-bold tracking-wider">Accuracy</div>
            </div>
        </div>
</div>

<!-- Detailed Results Card -->
<div class="bg-white dark:bg-slate-900 rounded-xl lg:rounded-2xl shadow-xl shadow-slate-200/50 dark:shadow-none border border-slate-100 dark:border-slate-800 p-4 lg:p-6 relative overflow-hidden group">
<div class="absolute top-0 left-0 w-2 h-full bg-green-500 opacity-0 group-hover:opacity-100 transition-opacity"></div>
<div class="flex items-center justify-between mb-6">
<h3 class="text-xl font-bold text-slate-800 dark:text-slate-200">Detailed Answers</h3>
<div class="flex items-center gap-2">
<span class="text-sm text-gray-500">Review your performance</span>
</div>
</div>

<div class="space-y-4" id="answers-container">
{% for result in results.detailed_results %}
<div class="mb-6 p-6 rounded-xl border-2 {% if result.is_correct %}bg-green-50 border-green-200{% else %}bg-red-50 border-red-200{% endif %}">
<div class="flex items-start justify-between mb-4">
<div class="flex items-center">
<span class="text-lg font-semibold text-gray-900 mr-3">Q{{ result.question_number }}</span>
{% if result.is_correct %}
<span class="material-symbols-outlined text-green-600">check_circle</span>
{% else %}
<span class="material-symbols-outlined text-red-600">cancel</span>
{% endif %}
</div>
<span class="text-sm {% if result.is_correct %}text-green-600{% else %}text-red-600{% endif %} font-medium">
{% if result.is_correct %}Correct{% else %}Incorrect{% endif %}
</span>
</div>

<div class="mb-4">
<p class="text-gray-900 dark:text-white font-medium mb-3">{{ result.question }}</p>

<div class="space-y-2">
{% for option in result.options %}
<div class="flex items-center p-2 rounded {% if forloop.counter0 == result.correct_answer %}bg-green-100{% endif %} {% if forloop.counter0 == result.user_answer and not result.is_correct %}bg-red-100{% endif %}">
<span class="text-sm font-medium {% if forloop.counter0 == result.correct_answer %}text-green-700{% elif forloop.counter0 == result.user_answer and not result.is_correct %}text-red-700{% else %}text-gray-600{% endif %}">
{{ forloop.counter0|add:1 }}. {{ option }}
</span>
{% if forloop.counter0 == result.correct_answer %}<span class="ml-2 text-xs text-green-600 font-medium">(Correct Answer)</span>{% endif %}
{% if forloop.counter0 == result.user_answer and not result.is_correct %}<span class="ml-2 text-xs text-red-600 font-medium">(Your Answer)</span>{% endif %}
</div>
{% endfor %}
</div>
</div>

<div class="flex items-center justify-between text-sm">
<div>
<span class="text-gray-600">Your Answer: </span>
{% if result.user_answer is not None %}
<span class="font-medium {% if result.is_correct %}text-green-600{% else %}text-red-600{% endif %}">{{ result.user_answer|add:1 }}.</span>
{% else %}
<span class="font-medium text-gray-500">Not Answered</span>
{% endif %}
</div>
<div>
<span class="text-gray-600">Correct Answer: </span>
<span class="font-medium text-green-600">{{ result.correct_answer|add:1 }}.</span>
</div>
</div>
</div>
{% endfor %}
</div>
</div>
</div>

        <!-- Action Buttons -->
        <div class="flex flex-col sm:flex-row items-center justify-center pt-6 pb-8 gap-4 px-4">
            {% if is_personalized_assessment %}
            <button onclick="createPersonalizedPlan()" class="w-full sm:w-auto px-6 py-4 bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 text-white font-bold rounded-2xl shadow-xl shadow-purple-500/20 transform hover:scale-[1.02] active:scale-[0.98] transition-all flex items-center justify-center gap-2">
                <span class="material-symbols-outlined">school</span>
                <span>Personalized Plan</span>
            </button>
            {% endif %}
            <button onclick="retakeTest()" class="w-full sm:w-auto px-6 py-4 bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white font-bold rounded-2xl shadow-xl shadow-blue-500/20 transform hover:scale-[1.02] active:scale-[0.98] transition-all flex items-center justify-center gap-2">
                <span class="material-symbols-outlined">refresh</span>
                <span>Retake Test</span>
            </button>
            <button onclick="backToDashboard()" class="w-full sm:w-auto px-6 py-4 bg-slate-800 dark:bg-slate-700 hover:bg-slate-900 dark:hover:bg-slate-600 text-white font-bold rounded-2xl transition-all flex items-center justify-center gap-2">
                <span class="material-symbols-outlined">dashboard</span>
                <span>Dashboard</span>
            </button>
        </div>
</div>
</section>

<!-- Right Sidebar -->
<aside class="fixed lg:relative w-80 bg-white dark:bg-slate-900 border-l border-slate-200 dark:border-slate-800 flex flex-col transform translate-x-full lg:translate-x-0 transition-transform duration-300 z-40 h-screen lg:h-auto" id="sidebar">
<div class="p-4 border-b border-slate-100 dark:border-slate-800">
<div class="flex items-center justify-between mb-4">
<h3 class="font-bold text-lg">Test Summary</h3>
<div class="flex items-center gap-2">
<span class="material-symbols-outlined text-slate-400 text-xl">summarize</span>
<button onclick="toggleSidebar()" class="lg:hidden p-2 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-800">
<span class="material-symbols-outlined text-slate-600 dark:text-slate-400">close</span>
</button>
</div>
</div>
<div class="grid grid-cols-2 gap-3">
<div class="p-3 bg-green-50 dark:bg-green-900/30 rounded-xl flex items-center gap-2">
<div class="w-3 h-3 rounded-full bg-green-500"></div>
<span class="text-[10px] font-bold uppercase text-green-700 dark:text-green-300">Score: {{ results.correct_answers }}</span>
</div>
<div class="p-3 bg-blue-50 dark:bg-blue-900/30 rounded-xl flex items-center gap-2">
<div class="w-3 h-3 rounded-full bg-blue-500"></div>
<span class="text-[10px] font-bold uppercase text-blue-700 dark:text-blue-300">Total: {{ results.total_questions }}</span>
</div>
</div>
</div>
<div class="flex-1 overflow-y-auto p-4 no-scrollbar">
<div class="space-y-4">

<div class="p-4 bg-slate-50 dark:bg-slate-800/50 rounded-xl">
<h4 class="font-semibold text-slate-800 dark:text-slate-200 mb-3">Quick Actions</h4>
<div class="space-y-2">
<button onclick="retakeTest()" class="w-full py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg text-sm font-medium transition-colors">
Retake Test
</button>
<button onclick="backToDashboard()" class="w-full py-2 bg-gray-600 hover:bg-gray-700 text-white rounded-lg text-sm font-medium transition-colors">
Dashboard
</button>
</div>
</div>
<div class="p-4 bg-slate-50 dark:bg-slate-800/50 rounded-xl">
<h4 class="font-semibold text-slate-800 dark:text-slate-200 mb-3">Performance Level</h4>
<div class="text-center">
<div class="text-2xl font-bold text-{{ performance_color|default:'gray' }}-600">{{ results.performance_level }}</div>
<p class="text-sm text-slate-600 dark:text-slate-400 mt-1">{{ results.message }}</p>
</div>
</div>
<div class="p-4 bg-slate-50 dark:bg-slate-800/50 rounded-xl">
<h4 class="font-semibold text-slate-800 dark:text-slate-200 mb-3">Statistics</h4>
<div class="space-y-3">
<div class="flex justify-between items-center">
<span class="text-sm text-slate-600 dark:text-slate-400">Correct</span>
<span class="font-bold text-green-600">{{ results.correct_answers }}</span>
</div>
<div class="flex justify-between items-center">
<span class="text-sm text-slate-600 dark:text-slate-400">Wrong</span>
<span class="font-bold text-red-600">{{ results.wrong_answers }}</span>
</div>
<div class="flex justify-between items-center">
<span class="text-sm text-slate-600 dark:text-slate-400">Total</span>
<span class="font-bold text-blue-600">{{ results.total_questions }}</span>
</div>
<div class="flex justify-between items-center">
<span class="text-sm text-slate-600 dark:text-slate-400">Accuracy</span>
<span class="font-bold text-purple-600">{{ results.percentage }}%</span>
</div>
</div>
</div>
</div>
</div>
<div class="p-4 border-t border-slate-100 dark:border-slate-800 bg-white dark:bg-slate-900">
<div class="text-center">
<p class="text-xs text-slate-500 dark:text-slate-400 mb-2">Test completed successfully</p>
<div class="w-full bg-green-100 dark:bg-green-900/30 rounded-full h-2">
<div class="bg-green-500 h-2 rounded-full" style="width: {{ results.percentage }}%"></div>
</div>
</div>
</div>
</aside>
</main>

<script>
// Theme toggle
function toggleTheme() {
    document.documentElement.classList.toggle('dark');
}

// Toggle sidebar
function toggleSidebar() {
    const sidebar = document.getElementById('sidebar');
    sidebar.classList.toggle('translate-x-full');
}

// Get performance color
function getPerformanceColor(level) {
    switch(level.toLowerCase()) {
        case 'excellent': return 'green';
        case 'good': return 'blue';
        case 'average': return 'yellow';
        case 'below average': return 'orange';
        case 'needs improvement': return 'red';
        default: return 'gray';
    }
}

// Back to dashboard
function backToDashboard() {
    // sessionStorage.clear(); // Removed to prevent session loss
    window.location.href = '/UserHome/';
}

// Retake test
function retakeTest() {
    // sessionStorage.clear(); // Removed to prevent session loss
    window.location.href = '/mock-test/';
}

// Create personalized plan
function createPersonalizedPlan() {
    // sessionStorage.clear(); // Don't clear session storage as we might need it
    window.location.href = '/personalized-plan/create-from-assessment/';
}

{% if is_personalized_assessment %}
// Auto-redirect for personalized plan
document.addEventListener('DOMContentLoaded', function() {
    setTimeout(function() {
        createPersonalizedPlan();
    }, 5000); // Auto-redirect after 5 seconds
    
    // Add a notification
    const actionContainer = document.querySelector('.flex.flex-col.sm\\:flex-row');
    if (actionContainer) {
        const msg = document.createElement('div');
        msg.className = 'w-full text-center text-sm text-gray-500 mt-2';
        msg.innerHTML = 'Redirecting to your personalized plan in 5 seconds...';
        actionContainer.appendChild(msg);
    }
});
{% endif %}

// Load results from sessionStorage if not in template context
document.addEventListener('DOMContentLoaded', function() {
    // Check if results are already in the template context
    const resultsElement = document.getElementById('results-data');
    if (!resultsElement || !resultsElement.hasAttribute('data-results-loaded')) {
        console.log("Template results not found, checking sessionStorage...");
        // Load from sessionStorage
        const storedResults = sessionStorage.getItem('testResults');
        if (storedResults) {
            try {
                const results = JSON.parse(storedResults);
                displayResults(results);
            } catch (e) {
                console.error("Error parsing stored results:", e);
                window.location.href = '/UserHome/';
            }
        } else {
            console.log("No results in sessionStorage either, redirecting to dashboard...");
            // No results found, redirect to dashboard
            // Wait a bit to show the 404/Empty state if it's just a slow load
            setTimeout(() => {
                const percentageElement = document.querySelector('.text-3xl.font-black');
                if (!percentageElement || percentageElement.textContent.trim() === '0%' || percentageElement.textContent.trim() === '%') {
                    window.location.href = '/UserHome/';
                }
            }, 3000);
        }
    } else {
        console.log("Results already loaded from server template.");
    }
});

function displayResults(results) {
    // Update percentage
    const percentageElement = document.querySelector('.text-3xl.font-black');
    if (percentageElement) {
        percentageElement.textContent = results.percentage + '%';
    }
    
    // Update performance level
    const performanceElement = document.querySelector('.inline-flex.items-center');
    if (performanceElement) {
        const color = getPerformanceColor(results.performance_level);
        performanceElement.className = `inline-flex items-center px-4 py-2 bg-${color}-100 text-${color}-800 rounded-full text-lg font-medium mb-4`;
        performanceElement.textContent = results.performance_level;
    }
    
    // Update message
    const messageElement = document.querySelector('.text-gray-600.text-lg');
    if (messageElement) {
        messageElement.textContent = results.message;
    }
    
    // Update stats
    const stats = [
        { selector: '.text-green-600', value: results.correct_answers },
        { selector: '.text-red-600', value: results.wrong_answers },
        { selector: '.text-blue-600', value: results.total_questions },
        { selector: '.text-purple-600', value: results.percentage }
    ];
    
    stats.forEach(stat => {
        const element = document.querySelector(stat.selector);
        if (element) {
            element.textContent = stat.value;
        }
    });
    
    // Update detailed answers
    const answersContainer = document.getElementById('answers-container');
    if (answersContainer && results.detailed_results) {
        answersContainer.innerHTML = '';
        
        results.detailed_results.forEach(result => {
            const answerCard = document.createElement('div');
            answerCard.className = `mb-6 p-6 rounded-xl border-2 ${result.is_correct ? 'bg-green-50 border-green-200' : 'bg-red-50 border-red-200'}`;
            
            const correctAnswerText = result.correct_answer !== null ? String.fromCharCode(65 + result.correct_answer) : 'N/A';
            const userAnswerText = result.user_answer !== null ? String.fromCharCode(65 + result.user_answer) : 'Not Answered';
            
            answerCard.innerHTML = `
                <div class="flex items-start justify-between mb-4">
                    <div class="flex items-center">
                        <span class="text-lg font-semibold text-gray-900 mr-3">Q${result.question_number}</span>
                        ${result.is_correct ? 
                            '<span class="material-symbols-outlined text-green-600">check_circle</span>' : 
                            '<span class="material-symbols-outlined text-red-600">cancel</span>'
                        }
                    </div>
                    <span class="text-sm ${result.is_correct ? 'text-green-600' : 'text-red-600'} font-medium">
                        ${result.is_correct ? 'Correct' : 'Incorrect'}
                    </span>
                </div>
                
                <div class="mb-4">
                    <p class="text-gray-900 dark:text-white font-medium mb-3">${result.question}</p>
                    
                    <div class="space-y-2">
                        ${result.options.map((option, i) => `
                            <div class="flex items-center p-2 rounded ${i === result.correct_answer ? 'bg-green-100' : ''} ${i === result.user_answer && !result.is_correct ? 'bg-red-100' : ''}">
                                <span class="text-sm font-medium ${i === result.correct_answer ? 'text-green-700' : i === result.user_answer && !result.is_correct ? 'text-red-700' : 'text-gray-600'}">
                                    ${String.fromCharCode(65 + i)}. ${option}
                                </span>
                                ${i === result.correct_answer ? '<span class="ml-2 text-xs text-green-600 font-medium">(Correct Answer)</span>' : ''}
                                ${i === result.user_answer && !result.is_correct ? '<span class="ml-2 text-xs text-red-600 font-medium">(Your Answer)</span>' : ''}
                            </div>
                        `).join('')}
                    </div>
                </div>
                
                <div class="flex items-center justify-between text-sm">
                    <div>
                        <span class="text-gray-600">Your Answer: </span>
                        <span class="font-medium ${result.is_correct ? 'text-green-600' : 'text-red-600'}">${userAnswerText}</span>
                    </div>
                    <div>
                        <span class="text-gray-600">Correct Answer: </span>
                        <span class="font-medium text-green-600">${correctAnswerText}</span>
                    </div>
                </div>
            `;
            
            answersContainer.appendChild(answerCard);
        });
    }
}
</script>
</body></html>
